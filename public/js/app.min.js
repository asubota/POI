/*! POI - v0.0.1 - 2014-06-25 */
var PoiManager=new Marionette.Application;PoiManager.Poi=Backbone.Model.extend({defaults:function(){return{title:"New POI title",description:"New POI description",lat:null,lng:null,visited:!1,photo:null}},urlRoot:"/api/pois"}),PoiManager.PoiCollection=Backbone.Collection.extend({model:PoiManager.Poi,url:"/api/pois",comparator:"title",visited:function(){return this.where({visited:!0})}}),PoiManager.PoiItemView=Marionette.ItemView.extend({template:"#template-poi-item",className:"column",modelEvents:{change:"render"},events:{"click .poi-delete-btn":"clear","click .poi-info-btn":"showDetails","click .poi-edit-btn":"showModal"},clear:function(){this.model.destroy()},showModal:function(){var a=new PoiManager.ModalView({model:this.model,collection:this.model.collection});PoiManager.modalRegion.show(a),$(".ui.modal").modal("show")},showDetails:function(){var a=new PoiManager.DetailsView({model:this.model});PoiManager.detailsRegion.show(a)}}),PoiManager.PoisView=Marionette.CompositeView.extend({childView:PoiManager.PoiItemView,className:"ui one column grid",template:"#template-poi-list",childViewContainer:"div.poi-list-items",events:{"click .poi-new-btn":"showModal"},showModal:function(){var a=new PoiManager.ModalView({model:new PoiManager.Poi,collection:this.collection});PoiManager.modalRegion.show(a),$(".ui.modal").modal("show")}}),PoiManager.ModalView=Marionette.ItemView.extend({template:"#template-modal",className:"ui modal",events:{"click .poi-save-btn":"trySave"},trySave:function(){var a=["title","description","lat","lng"],b={};_.each(a,function(a){b[a]=this.$(".poi-"+a).val()},this),this.model.isNew()&&this.collection.add(this.model),this.model.save(b)}}),PoiManager.DetailsView=Marionette.ItemView.extend({template:"#template-details",className:"sss"});var map=L.map("map").setView([51,31],10);L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png").addTo(map),PoiManager.addRegions({modalRegion:".poi-modal-region",poisRegion:".poi-list-region",detailsRegion:".poi-details-region"}),PoiManager.on("start",function(){var a=new PoiManager.PoiCollection;a.fetch();var b=new PoiManager.PoisView({collection:a});PoiManager.poisRegion.show(b)}),PoiManager.start();